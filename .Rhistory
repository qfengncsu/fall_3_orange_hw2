palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c(1,2,3,4),
legend = "bottom",
ggtheme = theme_bw(),
title = "this is the title"
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c(1,2,3,4),
legend = "bottom",
ggtheme = theme_bw(),
title = "Kaplan-Meier Curve Stratify by Failure Reason"
)
# log-rank test
survdiff(Surv(katrina$hour, katrina$survive==0) ~ katrina$reason, rho = 0, data = katrina, subset = katrina$reason != 0)
# pairwise comparison
pairwise_survdiff(Surv(time = hour, event = survive == 0) ~ reason, rho = 0, data = katrina[katrina$reason != 0,])
# here, i am making a new variable hour2, where i'm setting censored observations
# to have hour2 = 49 so that the function doesn't plot them as if they all had
# the event in the last week
katrina$hour2 <- ifelse(katrina$hour == 48 & katrina$survive == 1, 49, katrina$hour)
# create a new variable survive2 that is the opposite of survive
### we did this because kphaz.fit() automatically assumes 0 is censored
### and 1 is the event, and it doesn't look like this can be changed.
katrina$survive2 <- ifelse(katrina$survive==0, 1, 0)
# kphaz.fit() has the same arguments as Surv()
katrina_haz <- with(katrina, kphaz.fit(hour2, survive2))
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "hazard function")
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c(1,2,3,4),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c(1,2,3,4),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c(1,2,3,4),
ggtheme = theme_bw()
)
ggsurvplot(katrina_fit, data = katrina, xlab= "Time (in hours)",
conf.int = TRUE, palette = "grey")
#plot the survival curve with no stratification
ggsurvplot(katrina_fit, data = katrina, xlab= "Time (in hours)",
conf.int = TRUE, palette = "grey",
legend.title = "Reason for Pump Failure"
)
#plot the survival curve with no stratification
ggsurvplot(katrina_fit, data = katrina, xlab= "Time (in hours)",
conf.int = TRUE, palette = "grey",
legend.title = "Reason for Pump Failure",
ggtheme = theme_bw()
)
#plot the survival curve with no stratification
ggsurvplot(katrina_fit, data = katrina, xlab= "Time (in hours)",
conf.int = TRUE, palette = "#F4CC70",
legend.title = "Reason for Pump Failure",
ggtheme = theme_bw()
)
#plot the survival curve with no stratification
ggsurvplot(katrina_fit, data = katrina, xlab= "Time (in hours)",
conf.int = TRUE, palette = "#DE7A22",
legend.title = "Reason for Pump Failure",
ggtheme = theme_bw()
)
#plot the survival curve with no stratification
ggsurvplot(katrina_fit, data = katrina, xlab= "Time (in hours)",
conf.int = TRUE, palette = "#20948B",
legend.title = "Reason for Pump Failure",
ggtheme = theme_bw()
)
#plot the survival curve with no stratification
ggsurvplot(katrina_fit, data = katrina, xlab= "Time (in hours)",
conf.int = TRUE, palette = "#A43820",
legend.title = "Reason for Pump Failure",
ggtheme = theme_bw()
)
#plot the survival curve with no stratification
ggsurvplot(katrina_fit, data = katrina, xlab= "Time (in hours)",
conf.int = TRUE, palette = "#20948B",
legend.title = "Reason for Pump Failure",
ggtheme = theme_bw()
)
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "hazard function")
### cumulative hazard ###
ggsurvplot(katrina_fit, fun = "cumhaz", palette = "grey")
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "hazard function")
### cumulative hazard ###
ggsurvplot(katrina_fit, fun = "cumhaz", palette = "grey")
# need these packages
library(data.table)
library(survival)
library(survminer)
library(muhaz)
katrina <- fread('Survival Analysis/Data/katrina.csv')
# create a survival curve with no stratification
# survive==0 since we're interested in pump failure (non-survival)
katrina_fit <- survfit(Surv(katrina$hour, katrina$survive==0) ~ 1, data=katrina)
# calling this gives the sample size, #events (survive==0, failure), median, and CI
katrina_fit
#plot the survival curve with no stratification
ggsurvplot(katrina_fit, data = katrina, xlab= "Time (in hours)",
conf.int = TRUE, palette = "#20948B",
legend.title = "Reason for Pump Failure",
ggtheme = theme_bw()
)
# stratify by reason and plot
katrina_reason <- survfit(Surv(katrina$hour, katrina$survive==0) ~ katrina$reason, data = katrina, subset = katrina$reason !=0)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c(1,2,3,4),
ggtheme = theme_bw()
)
# the summary gives us the time, number at risk, number of events,
summary(katrina_fit)
# log-rank test
survdiff(Surv(katrina$hour, katrina$survive==0) ~ katrina$reason, rho = 0, data = katrina, subset = katrina$reason != 0)
# pairwise comparison
pairwise_survdiff(Surv(time = hour, event = survive == 0) ~ reason, rho = 0, data = katrina[katrina$reason != 0,])
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "hazard function")
# here, i am making a new variable hour2, where i'm setting censored observations
# to have hour2 = 49 so that the function doesn't plot them as if they all had
# the event in the last week
katrina$hour2 <- ifelse(katrina$hour == 48 & katrina$survive == 1, 49, katrina$hour)
# create a new variable survive2 that is the opposite of survive
### we did this because kphaz.fit() automatically assumes 0 is censored
### and 1 is the event, and it doesn't look like this can be changed.
katrina$survive2 <- ifelse(katrina$survive==0, 1, 0)
# kphaz.fit() has the same arguments as Surv()
katrina_haz <- with(katrina, kphaz.fit(hour2, survive2))
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "hazard function")
### cumulative hazard ###
ggsurvplot(katrina_fit, fun = "cumhaz", palette = "grey")
katrina_haz
# need these packages
library(data.table)
library(survival)
library(survminer)
library(muhaz)
katrina <- fread('Survival Analysis/Data/katrina.csv')
# create a survival curve with no stratification
# survive==0 since we're interested in pump failure (non-survival)
katrina_fit <- survfit(Surv(katrina$hour, katrina$survive==0) ~ 1, data=katrina)
#plot the survival curve with no stratification
ggsurvplot(katrina_fit, data = katrina, xlab= "Time (in hours)",
conf.int = TRUE, palette = "#20948B",
legend.title = "Reason for Pump Failure",
ggtheme = theme_bw()
)
# stratify by reason and plot
katrina_reason <- survfit(Surv(katrina$hour, katrina$survive==0) ~ katrina$reason, data = katrina, subset = katrina$reason !=0)
katrina_reason
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c(1,2,3,4),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed' (size=100)),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
font.legend = list(size=14),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
font.legend = list(size=12),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
legend = 'left'
font.legend = list(size=12),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
legend = 'left',
font.legend = list(size=12),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
legend = 'bottom',
font.legend = list(size=12),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
legend = 'bottom',
font.legend = list(size=12),
main = 'Survival Curves by Failure Reason'
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
legend = 'bottom',
font.legend = list(size=12),
main = 'Survival Curves by Failure Reason',
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
legend = 'bottom',
font.legend = list(size=12),
title = 'Survival Curves by Failure Reason',
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
legend = 'bottom',
font.legend = list(size=12),
title = 'Survival Curves by Failure Reason',
title = 'center',
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
legend = 'bottom',
font.legend = list(size=12),
title = '     Survival Curves by Failure Reason',
title = 'center',
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
legend = 'bottom',
font.legend = list(size=12),
title = '     Survival Curves by Failure Reason',
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
legend = 'bottom',
font.legend = list(size=12),
title = "Survival curves",
subtitle = "Based on Kaplan-Meier estimates",
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
legend = 'bottom',
font.legend = list(size=12),
title(main='Survival Curves by Failure Reason',outer=FALSE),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
legend = 'bottom',
font.legend = list(size=12),
title='Survival Curves by Failure Reason',
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
font.legend = list(size=12),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
font.x=c(12)
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
font.legend = list(size=12),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
font.x=c(12),
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
font.legend = list(size=12),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
font.x=14,
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
font.legend = list(size=12),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
font.x=14,
font.y=14,
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
font.legend = list(size=12),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
font.x=14,
font.y=14,
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
font.legend = list(size=14),
ggtheme = theme_bw()
)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
font.x=16,
font.y=16,
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
font.legend = list(size=16),
ggtheme = theme_bw()
)
katrina_reason
# need these packages
library(data.table)
library(survival)
library(survminer)
library(muhaz)
katrina <- fread('Survival Analysis/Data/katrina.csv')
# create a survival curve with no stratification
# survive==0 since we're interested in pump failure (non-survival)
katrina_fit <- survfit(Surv(katrina$hour, katrina$survive==0) ~ 1, data=katrina)
# calling this gives the sample size, #events (survive==0, failure), median, and CI
katrina_fit #### do we need to stratify median by reason?
# the summary gives us the time, number at risk, number of events,
summary(katrina_fit)
# stratify by reason and plot
katrina_reason <- survfit(Surv(katrina$hour, katrina$survive==0) ~ katrina$reason, data = katrina, subset = katrina$reason !=0)
katrina_reason
# log-rank test
survdiff(Surv(katrina$hour, katrina$survive==0) ~ katrina$reason, rho = 0, data = katrina, subset = katrina$reason != 0)
# pairwise comparison
pairwise_survdiff(Surv(time = hour, event = survive == 0) ~ reason, rho = 0, data = katrina[katrina$reason != 0,])
# here, i am making a new variable hour2, where i'm setting censored observations
# to have hour2 = 49 so that the function doesn't plot them as if they all had
# the event in the last week
katrina$hour2 <- ifelse(katrina$hour == 48 & katrina$survive == 1, 49, katrina$hour)
# create a new variable survive2 that is the opposite of survive
### we did this because kphaz.fit() automatically assumes 0 is censored
### and 1 is the event, and it doesn't look like this can be changed.
katrina$survive2 <- ifelse(katrina$survive==0, 1, 0)
# kphaz.fit() has the same arguments as Surv()
katrina_haz <- with(katrina, kphaz.fit(hour2, survive2))
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "hazard function")
katrina_haz
# extract values from katrina_haz and create better visualizaiton.
k_time <- katrina_haz$time
k_haz <- katrina_haz$haz
hazard_df <- as.data.frame(c(k_time, k_haz))
View(hazard_df)
View(hazard_df)
hazard_df <- as.data.frame((k_time, k_haz))
hazard_df <- as.data.frame(cbind(k_time, k_haz))
View(hazard_df)
View(hazard_df)
library(dplyr)
library(ggplots2)
library(ggplot2)
ggplot(data=hazard_df)
ggplot(data=hazard_df, y=hazard_df$k_time, x=hazard_df$k_haz)
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "Hazard Function", xlab='Time (in hour)')
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "Hazard Function", x='Time (in hour)')
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "Hazard Function",
xlab="Time (in hour)"
)
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "Hazard Function",
xlab="Time (in hour)",
ylab="test"
)
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "Hazard Function", color='blue')
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "Hazard Function", plot.color='blue')
warnings()
katrina_reason
# stratify by reason and plot
katrina_reason <- survfit(Surv(katrina$hour, katrina$survive==0) ~ katrina$reason, data = katrina, subset = katrina$reason !=0)
katrina_reason
# the summary gives us the time, number at risk, number of events,
summary(katrina_fit)
# need these packages
library(data.table)
library(survival)
library(survminer)
library(muhaz)
library(ggplot2)
katrina <- fread('Survival Analysis/Data/katrina.csv')
# create a survival curve with no stratification
# survive==0 since we're interested in pump failure (non-survival)
katrina_fit <- survfit(Surv(katrina$hour, katrina$survive==0) ~ 1, data=katrina)
#plot the survival curve with no stratification
ggsurvplot(katrina_fit, data = katrina, xlab= "Time (in hours)",
conf.int = TRUE, palette = "#20948B",
legend.title = "Reason for Pump Failure",
ggtheme = theme_bw()
)
# stratify by reason and plot
katrina_reason <- survfit(Surv(katrina$hour, katrina$survive==0) ~ katrina$reason, data = katrina, subset = katrina$reason !=0)
ggsurvplot(katrina_reason, conf.int = TRUE,
palette=c("#F4CC70", "#DE7A22","#20948B","#A43820"),
xlab = "Time (in hours)",
font.x=16,
font.y=16,
legend.title = "Reason for Pump Failure",
legend.labs = c('flood','motor','surge','jammed'),
font.legend = list(size=16),
ggtheme = theme_bw()
)
# log-rank test
survdiff(Surv(katrina$hour, katrina$survive==0) ~ katrina$reason, rho = 0, data = katrina, subset = katrina$reason != 0)
# pairwise comparison
pairwise_survdiff(Surv(time = hour, event = survive == 0) ~ reason, rho = 0, data = katrina[katrina$reason != 0,])
# here, i am making a new variable hour2, where i'm setting censored observations
# to have hour2 = 49 so that the function doesn't plot them as if they all had
# the event in the last week
katrina$hour2 <- ifelse(katrina$hour == 48 & katrina$survive == 1, 49, katrina$hour)
s
# create a new variable survive2 that is the opposite of survive
### we did this because kphaz.fit() automatically assumes 0 is censored
### and 1 is the event, and it doesn't look like this can be changed.
katrina$survive2 <- ifelse(katrina$survive==0, 1, 0)
# kphaz.fit() has the same arguments as Surv()
katrina_haz <- with(katrina, kphaz.fit(hour2, survive2))
# and we plot it with kphaz.plot()
kphaz.plot(katrina_haz, main = "Hazard Function")
